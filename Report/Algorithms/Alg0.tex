\begin{algorithm}[h!]
	\caption{Augmented sphere decoder for c2}
	\label{alg:1}
	\begin{algorithmic}[1]
		\State Function: augPSphDec
		\State Input: $\b{U}_\augp(k)$, $\b{U}_\augp^\opt(k)$, $d^2$, $i$, $N_\p$, $\rho^2$, $\hat{\b{U}}_\augp(k)$, $\b{V}_\augp$, $\b{u}_\augp(k-1)$
		\State Output: $\b{U}_\augp^\opt(k)$, $\rho^2$\\
		%
		\State $j \gets \left\{ \begin{array}{ll}
			6, & \text{ if mod} (i,6) = 0\\
			\mathrm{mod}(i,6), & \text{ otherwise}
		\end{array} \right.$
		\Comment{Count of phase index $j$ in $\b{u}\left(k + \left\lfloor \frac{i-1}{6} \right\rfloor\right)$.}
		\If{$1 \leq j < 4$}
		\Comment{current node $i$ is a switching state $u_{\ph,(z)}\left(k + \left\lfloor \frac{i-1}{6} \right\rfloor\right),\ z\in\{\A,\B,\C\}$}
		\State $\mathcal{U} \gets \{-1,\ 0,\ 1\}$
		\Comment{assign all possible switch positions to $\mathcal{U}$}
		\Else
		\State $\mathcal{U} \gets \{|u_{\augp,(i-3)}(k) - u_{\augp,(j-3)}(k-1)|$\}
		\Comment{assign value of $p_{(z)}\left(k + \left\lfloor \frac{i-1}{6} \right\rfloor\right),\ z\in\{\A,\B,\C\}$}
		\EndIf\\
		%
		\ForAll{$u\in\mathcal{U}$}
		\State $u_{\augp,i}(k) \gets u$
		\State $d_{i+1}^2 \gets || \hat{U}_{\augp,(i)}(k) - \b{V}_{\augp,(i)}\b{U}_\augp(k) ||_2^2 + d^2$
		\Comment{Calculate the new cost $d_{i+1}^2$.}\\
		%
		\If{$d_{i+1}^2 < \rho^2$}
		\Comment{Check if new cost is smaller than the sphere radius $\rho$}
		\If{$i < 6N_\p$}
		\If{$j = 6$}
		\State $\b{u}_\augp(k-1) \gets \b{U}_{\augp,(i-5:i)}(k)$
		\Comment{Reassign $\b{u}_\augp(k-1)$ for next time step}
		\EndIf
		\State $[\b{U}_\augp^\opt(k)$, $\rho^2]$ $\gets$ augPShpDec($\b{U}_\augp(k)$, $\b{U}_\augp^\opt(k)$, $d^2$, $i$, $N_\p$, $\rho^2$, $\hat{\b{U}}_\augp(k)$, $\b{V}_\augp$, $\b{u}_\augp(k-1)$)
		\Else
		\State $\b{U}_\augp^\opt(k) \gets \b{U}_\augp(k)$
		\Comment{Reassign optimal values if $d_{6N_\p} < \rho$}
		\State $\rho^2 \gets d^2$
		\EndIf
		\EndIf
		\EndFor
	\end{algorithmic}
\end{algorithm}